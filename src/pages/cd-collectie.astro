---
import PageLayout from "@/layouts/Base.astro";
import FilterSortList from "@/components/FilterSortList.svelte";
// @ts-expect-error - TS/Astro linter ziet gebruik in slot soms niet goed
import CDCard from "@/components/CDCard.astro";
import cdCollectionData from "@/data/cd_collection.json";
// Gebruik het correcte pad met alias naar src/types.ts
import type { Release, Artist, SortOption, SiteMeta } from "@/types"; // Importeer ook SiteMeta

const releases: Release[] = cdCollectionData?.releases ?? [];

// --- Configuratie specifiek voor CD's ---
const searchFields: string[] = ["basic_information.title", "basic_information.artists"];

function formatArtistsForSort(artists: Artist[] | undefined): string {
	if (!artists || artists.length === 0) return "zzzzzzz";
	return artists
		.map((artist: Artist) => artist.name)
		.join(", ")
		.toLowerCase();
}

const sortOptions: SortOption[] = [
	{
		id: "artistAZ",
		label: "Artiest (A-Z)",
		order: "asc",
		valueFn: (item: Release) => formatArtistsForSort(item.basic_information?.artists),
	},
	{
		id: "artistZA",
		label: "Artiest (Z-A)",
		order: "desc",
		valueFn: (item: Release) => formatArtistsForSort(item.basic_information?.artists),
	},
	{
		id: "yearNewOld",
		label: "Jaar (Nieuw-Oud)",
		order: "desc",
		valueFn: (item: Release) => item.basic_information?.year ?? 0,
	},
	{
		id: "yearOldNew",
		label: "Jaar (Oud-Nieuw)",
		order: "asc",
		valueFn: (item: Release) => item.basic_information?.year ?? 9999,
	},
];

const initialSortId: string = "artistAZ";

// Definieer het meta object correct met vereiste velden zoals 'title'
const meta: SiteMeta = {
	title: "Mijn CD Collectie", // Vereiste titel toegevoegd
	description: "Een doorzoekbaar en sorteerbaar overzicht van mijn CD collectie.", // Beschrijving toegevoegd/aangepast
	// Voeg hier andere vereiste velden uit SiteMeta toe indien nodig
};
---

<PageLayout meta={meta}>
	<h1 class="title mb-6 text-2xl font-bold">Mijn CD Collectie</h1>

	<FilterSortList
		client:load
		items={releases}
		searchFields={searchFields}
		sortOptions={sortOptions}
		initialSortId={initialSortId}
	>
		{/* ... slots ... */}
	</FilterSortList>
</PageLayout>
